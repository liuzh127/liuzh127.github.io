---
layout: post
title: Linux基础配置
categories: [基础配置]
tags: [基础配置]
---
#### 1.	挂载安装文件ISO里面的yum源  
##### 1.1 上传ISO文件  
上传系统镜像文件CentOS-7.iso到目标服务器  
##### 1.2 设置挂载  
`# mkdir /media/cdrom`                                             
[新建镜像文件挂载目录]  
<!-- more -->
`# cd /media`                                                 
[进入系统镜像文件存放目录]  
`# ls`                                    
[列出目录文件，可以看到刚刚上传的系统镜像文件]  
`# mount -t iso9660 -o loop /home/CentOS-7.iso  /media/cdrom`   
[挂载系统镜像]  
`# cd /media/cdrom`                
[进入挂载目录，使用ls命令可以看到已经有文件存在了]  
<!-- more -->
##### 1.3 设置开机自启动  
`# vim /etc/fstab`  
[添加以下代码,实现开机自动挂载]  
`/home/CentOS-7.iso  /media/cdrom   iso9660 defaults,loop  0 0`  
##### 1.4 配置本地yum源  
[进入yum配置目录]  
`# cd /etc/yum.repos.d/`                                     
[建立yum配置文件]  
`# vim CentOS-7.repo`                            
[编辑配置文件，添加以下内容]  
`[CentOS-7]`  
`name=CentOS-7`   
`baseurl=file:///media/cdrom`     
`enabled=1`   
`gpgcheck=1`   
`gpgkey=file:///media/cdrom/RPM-GPG-KEY-CentOS-7`  
##### 1.5 测试yum是否正常   
`# yum clean all`                                                          
[清除yum缓存]  
`# yum makecache`                                       
[缓存本地yum源中的软件包信息]  
`# yum repolist`                                           
[显示本地yum源中的软件包信息]  
**挂载之后可能还是无法使用，进入/etc/yum.repos.d/ 将Centos.Base.repo重命名使其失效即可**  
**yum安装时出现类似“warning: rpmts_HdrFromFdno: Header V3 RSA/SHA256 Signature, key ID fd431d51: NOKEY”的报错，是导入了旧的KEY文件，执行`rpm --import /etc/pki/rpm-gpg/RPM*`导入新KEY即可**  
#### 2. 关闭iptables和selinux  
**1.查看防火墙状态**  
`# systemctl status firewalld.service`   
**2.停止firewall**  
`# systemctl stop firewalld.service`  
**3.禁止firewall开机启动**  
`# systemctl disable firewalld.service`  
**4.查看防火墙已经开放的端口**  
`# firewall-cmd --list-ports`  
**5.开放防火墙端口**  
`# firewall-cmd --zone=public --add-port=端口/tcp --permanent`  
**6.重启防火墙**  
`# systemctl reload firewalld`  
**7.关闭selinux**  
进入到/etc/selinux/config文件   
`#vi /etc/selinux/config`  
**将SELINUX=enforcing改为SELINUX=disabled**   
#### 3. 更改主机名和配置域名解析  
##### 3.1 更改主机名  
查看Linux的主机名：  
`# hostname`   
*localhost.localdomain*  
更改主机名：  
`# vi /etc/hostname`                   
**改为想要设置的主机名后重启**    
##### 3.2 设置本地域名解析  
在/etc/hosts文件中添加：  
`# vi /etc/hosts`   
192.168.0.1  AcroUC-node1.hbfec.com.cn                           
**一条一行，前面是IP，后面是域名，一个IP可以对应多个域名，相同的域名按最前面的IP解析**  
#### 4. 更改SSH端口
**1.修改ssh配置文件**  
`vi /etc/ssh/sshd_config`  
在`#Port 22`这行下边添加`Port 127`  
**2.修改centos7的远程端口**  
使用命令查看centos7允许的ssh的端口：  
`semanage port -l | grep ssh`  
*ssh_port_t                     tcp      22*  
添加18101端口到SELinux：  
`semanage port -a -t ssh_port_t -p tcp 127`  
确认是否添加成功：  
`semanage port -l | grep ssh`  
如果成功会输出  
`ssh_port_t                 tcp  127, 22`  
**3.重启SSH服务**  
`systemctl restart sshd.service`  
